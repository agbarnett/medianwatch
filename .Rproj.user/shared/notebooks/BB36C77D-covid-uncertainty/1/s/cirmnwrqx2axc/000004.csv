"0","# get the data"
"0","load('data/all_results_microsimulation_age.RData') # micro-simulation results with age-dependent rates"
"0","cbPalette <- c(""#E69F00"", ""#56B4E9"", ""#009E73"", ""#F0E442"", ""#0072B2"", ""#D55E00"", ""#CC79A7"", ""#999999"") # colours"
"0","# "
"0","transitions = mutate(all_results, "
"0","                     From = str_remove(From, pattern='f/|m/'), # remove genders"
"0","                     To = str_remove(To, pattern='f/|m/'))"
"0","# summary stats per simulation"
"0","age.mean = group_by(transitions, simnum, From, To) %>%"
"0","  summarise(mean = mean(transitionAge), Q1=quantile(transitionAge, 0.25), Q3=quantile(transitionAge, 0.75))"
"0","# plot, first remove hospital transitions"
"0","for.plot = filter(age.mean,"
"0","                  !From %in% c('HR','HS','HE','H1','R','S'),"
"0","                  !To %in% c('HR','HS','HE','H1','S','dead')) %>% # remove some transitions to neaten plot"
"0","  mutate("
"0","    FromNice = factor(From, levels=c('E','I1','I2','I3','R','D','HR','HS','H1','HE','dead'), # make nicer labels"
"0","                    labels = c('Exposed','Mild\ninfection','Severe\ninfection','Critical\ninfection','Recovered','Died - COVID','Hospital R','Hospital S','Hospital I1','Hospital E','Died - Other')),"
"0","    ToNice = factor(To, levels=c('E','I1','I2','I3','R','D','HR','HS','H1','HE','dead'), # make nicer labels"
"0","                         labels = c('Exposed','Mild infection','Severe infection','Critical infection','Recovered','Died - COVID','Hospital R','Hospital S','Hospital I1','Hospital E','Died - Other'))) "
"0","age.box = ggplot(data=for.plot, aes(x=FromNice, y=mean, fill=ToNice))+"
"0","  geom_boxplot()+"
"0","  scale_fill_manual('Transition to', values=cbPalette)+"
"0","  ylab('Age')+"
"0","  xlab('Transition from')"
"0","age.box"
